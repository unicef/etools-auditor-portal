<!--import [polymer, etools-content-panel, paper-tooltip]-->

<!--import [tab-inputs-styles, module-styles]-->

<dom-module id="follow-up-financial-findings">
    <template>
        <style include="tab-inputs-styles module-styles">
            :host {
                position: relative;
                margin-bottom: 24px;
                display: block;
            }
        </style>

        <etools-content-panel panel-title="Financial Findings">

            <template is="dom-if" if="[[showFields(engagement.engagement_type, 'audit')]]" restamp>
                <div class="row-h group">
                    <div class="input-container">
                        <!-- Audit Opinion -->
                        <etools-searchable-multiselection-menu
                                id="test"
                                class="disabled-as-readonly"
                                value="{{auditOpinion}}"
                                label="[[getLabel('audit_opinion', basePermissionPath)]]"
                                placeholder="[[getReadonlyPlaceholder(engagement)]]"
                                options="[[auditOpinionChoices]]"
                                custom-object-options
                                option-label="display_name"
                                option-value="value"
                                selected="{{engagement.audit_opinion}}"
                                update-selected
                                disabled readonly
                                no-title-attr="">
                        </etools-searchable-multiselection-menu>
                    </div>
                </div>
            </template>

            <div class="row-h group">
                <!--Audit engagement fields-->
                <template is="dom-if" if="[[showFields(engagement.engagement_type, 'audit')]]" restamp>
                    <div class="input-container">
                        <!-- Audited expenditure (USD)-->
                        <etools-currency-amount-input
                                class="disabled-as-readonly"
                                value="{{engagement.audited_expenditure}}"
                                currency="$"
                                label$="[[getLabel('audited_expenditure', basePermissionPath)]]"
                                placeholder$="[[getReadonlyPlaceholder(engagement)]]"
                                disabled readonly>
                        </etools-currency-amount-input>
                    </div>

                    <div class="input-container">
                        <!-- Financial Findings (USD)-->
                        <etools-currency-amount-input
                                class="disabled-as-readonly"
                                value="{{engagement.financial_findings}}"
                                currency="$"
                                label$="[[getLabel('financial_findings', basePermissionPath)]]"
                                placeholder$="[[getReadonlyPlaceholder(engagement)]]"
                                disabled readonly>
                        </etools-currency-amount-input>
                    </div>
                </template>

                <!--Spot-Check engagement fields-->
                <template is="dom-if" if="[[showFields(engagement.engagement_type, 'sc')]]" restamp>
                    <div class="input-container">
                        <!-- Total amount tested-->
                        <etools-currency-amount-input
                                class="disabled-as-readonly"
                                value="{{engagement.total_amount_tested}}"
                                currency="$"
                                label$="[[getLabel('total_amount_tested', basePermissionPath)]]"
                                placeholder$="[[getReadonlyPlaceholder(engagement)]]"
                                disabled readonly>
                        </etools-currency-amount-input>
                    </div>

                    <div class="input-container">
                        <!-- Total amount of ineligible expenditure-->
                        <etools-currency-amount-input
                                class="disabled-as-readonly"
                                value="{{engagement.total_amount_of_ineligible_expenditure}}"
                                currency="$"
                                label$="[[getLabel('total_amount_of_ineligible_expenditure', basePermissionPath)]]"
                                placeholder$="[[getReadonlyPlaceholder(engagement)]]"
                                disabled readonly>
                        </etools-currency-amount-input>
                    </div>
                </template>

                <!--  -->
                <div class="input-container">
                    <!--Amount refunded -->
                    <etools-currency-amount-input
                            class$="validate-input disabled-as-readonly [[_setRequired('amount_refunded', basePermissionPath)]]"
                            value="{{engagement.amount_refunded}}"
                            currency="$"
                            label$="[[getLabel('amount_refunded', basePermissionPath)]]"
                            placeholder$="[[getPlaceholderText('amount_refunded', basePermissionPath)]]"
                            required$="[[_setRequired('amount_refunded', basePermissionPath)]]"
                            disabled$="[[isReadOnly('amount_refunded', basePermissionPath)]]"
                            readonly$="[[isReadOnly('amount_refunded', basePermissionPath)]]"
                            invalid$="{{errors.amount_refunded}}"
                            error-message="{{errors.amount_refunded}}"
                            on-focus="_resetFieldError"
                            on-tap="_resetFieldError">
                    </etools-currency-amount-input>
                </div>
            </div>

            <div class="row-h group">
                <div class="input-container">
                    <!--Additional supporting documentation provided -->
                    <etools-currency-amount-input
                            class$="validate-input disabled-as-readonly [[_setRequired('additional_supporting_documentation_provided', basePermissionPath)]]"
                            value="{{engagement.additional_supporting_documentation_provided}}"
                            currency="$"
                            label$="[[getLabel('additional_supporting_documentation_provided', basePermissionPath)]]"
                            placeholder$="[[getPlaceholderText('additional_supporting_documentation_provided', basePermissionPath)]]"
                            required$="[[_setRequired('additional_supporting_documentation_provided', basePermissionPath)]]"
                            disabled$="[[isReadOnly('additional_supporting_documentation_provided', basePermissionPath)]]"
                            readonly$="[[isReadOnly('additional_supporting_documentation_provided', basePermissionPath)]]"
                            invalid$="{{errors.additional_supporting_documentation_provided}}"
                            error-message="{{errors.additional_supporting_documentation_provided}}"
                            on-focus="_resetFieldError"
                            on-tap="_resetFieldError">
                    </etools-currency-amount-input>
                </div>

                <div class="input-container">
                    <!-- Justification provided and accepted -->
                    <etools-currency-amount-input
                            class$="validate-input disabled-as-readonly [[_setRequired('justification_provided_and_accepted', basePermissionPath)]]"
                            value="{{engagement.justification_provided_and_accepted}}"
                            currency="$"
                            label$="[[getLabel('justification_provided_and_accepted', basePermissionPath)]]"
                            placeholder$="[[getPlaceholderText('justification_provided_and_accepted', basePermissionPath)]]"
                            required$="[[_setRequired('justification_provided_and_accepted', basePermissionPath)]]"
                            disabled$="[[isReadOnly('justification_provided_and_accepted', basePermissionPath)]]"
                            readonly$="[[isReadOnly('justification_provided_and_accepted', basePermissionPath)]]"
                            invalid$="{{errors.justification_provided_and_accepted}}"
                            error-message="{{errors.justification_provided_and_accepted}}"
                            on-focus="_resetFieldError"
                            on-tap="_resetFieldError">
                    </etools-currency-amount-input>
                </div>

                <div class="input-container">
                    <!--Write off required -->
                    <etools-currency-amount-input
                            class$="validate-input disabled-as-readonly [[_setRequired('write_off_required', basePermissionPath)]]"
                            value="{{engagement.write_off_required}}"
                            currency="$"
                            label$="[[getLabel('write_off_required', basePermissionPath)]]"
                            placeholder$="[[getPlaceholderText('write_off_required', basePermissionPath)]]"
                            required$="[[_setRequired('write_off_required', basePermissionPath)]]"
                            disabled$="[[isReadOnly('write_off_required', basePermissionPath)]]"
                            readonly$="[[isReadOnly('write_off_required', basePermissionPath)]]"
                            invalid$="{{errors.write_off_required}}"
                            error-message="{{errors.write_off_required}}"
                            on-focus="_resetFieldError"
                            on-tap="_resetFieldError">
                    </etools-currency-amount-input>
                </div>
            </div>

            <div class="row-h group">
                <div class="input-container">
                    <!-- Pending Unsupported Amount -->
                    <etools-currency-amount-input
                            class="disabled-as-readonly"
                            value="[[setUnsupportedAmount(engagement, engagement.additional_supporting_documentation_provided, engagement.amount_refunded, engagement.justification_provided_and_accepted, engagement.write_off_required)]]"
                            currency="$"
                            label$="[[getLabel('pending_unsupported_amount', basePermissionPath)]]"
                            placeholder$="[[getReadonlyPlaceholder(engagement)]]"
                            disabled readonly>
                    </etools-currency-amount-input>
                </div>
            </div>

            <div class="row-h group">
                <div class="input-container input-container-l">
                    <!-- explanation_for_additional_information -->
                    <paper-textarea
                            class$="validate-input {{_setRequired('explanation_for_additional_information', basePermissionPath)}}"
                            value="{{engagement.explanation_for_additional_information}}"
                            allowed-pattern="[\d\s]"
                            label="[[getLabel('explanation_for_additional_information', basePermissionPath)]]"
                            placeholder="[[getPlaceholderText('explanation_for_additional_information', basePermissionPath)]]"
                            required="{{_setRequired('explanation_for_additional_information', basePermissionPath)}}"
                            disabled="{{isReadOnly('explanation_for_additional_information', basePermissionPath)}}"
                            readonly$="{{isReadOnly('explanation_for_additional_information', basePermissionPath)}}"
                            invalid="{{errors.explanation_for_additional_information}}"
                            error-message="{{errors.explanation_for_additional_information}}"
                            on-focus="_resetFieldError"
                            on-tap="_resetFieldError">
                    </paper-textarea>
                </div>
            </div>

        </etools-content-panel>

    </template>

    <!-- inject scripts './follow-up-financial-findings.js'-->
</dom-module>