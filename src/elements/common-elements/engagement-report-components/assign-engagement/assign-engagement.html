<!--import [polymer, lodash, etools-content-panel, paper-input, etools-datepicker, paper-tooltip]-->
<!--import [tab-inputs-styles, tab-layout-styles, module-styles, date-behavior, custom-validator, permission-controller, common-methods-behavior]-->

<dom-module id="assign-engagement">
    <template>
        <style include="tab-inputs-styles tab-layout-styles module-styles">
        </style>

        <etools-content-panel class="content-section clearfx" panel-title="Engagement Status">
            <div class="row-h group">
                <div class="input-container">
                    <!-- Date of Field Visit -->
                    <paper-input
                            id="dateVisitInput"
                            class$="disabled-as-readonly [[_setRequired('date_of_field_visit', basePermissionPath)]] validate-date"
                            value="[[prettyDate(data.date_of_field_visit)]]"
                            label="[[getLabel('date_of_field_visit', basePermissionPath)]]"
                            placeholder="&#8212;"
                            data-selector="dateVisit"
                            required="[[_setRequired('date_of_field_visit', basePermissionPath)]]"
                            disabled$="[[_isReadOnly('date_of_field_visit', 'true', falseValue, basePermissionPath)]]"
                            invalid="{{_checkFieldInvalid(errors.date_of_field_visit)}}"
                            error-message="{{errors.date_of_field_visit}}"
                            validator="dateValidator"
                            on-focus="_resetFieldError"
                            on-tap="_resetFieldError"
                            on-down="openDatePicker">
                        <etools-datepicker
                                id="dateVisit"
                                modal="[[datepickerModal]]"
                                prefix
                                format="YYYY-MM-DD"
                                date="[[prepareDate(data.date_of_field_visit)]]"
                                pretty-date="{{data.date_of_field_visit}}"
                                no-init
                                show-clear-btn>
                        </etools-datepicker>
                    </paper-input>
                </div>

                <div class="input-container">
                    <!-- Draft Report Issued to IP -->
                    <paper-input
                            id="draftReportToIpInput"
                            class$="disabled-as-readonly [[_setRequired('date_of_draft_report_to_ip', basePermissionPath)]] validate-date"
                            value="[[prettyDate(data.date_of_draft_report_to_ip)]]"
                            label="[[getLabel('date_of_draft_report_to_ip', basePermissionPath)]]"
                            placeholder="&#8212;"
                            data-selector="draftReportToIp"
                            required="[[_setRequired('date_of_draft_report_to_ip', basePermissionPath)]]"
                            disabled$="[[_isReadOnly('date_of_draft_report_to_ip', 'true', data.date_of_comments_by_ip, basePermissionPath)]]"
                            invalid="{{_checkFieldInvalid(errors.date_of_draft_report_to_ip)}}"
                            error-message="{{errors.date_of_draft_report_to_ip}}"
                            validator="dateValidator"
                            on-focus="_resetFieldError"
                            on-tap="_resetFieldError"
                            on-down="openDatePicker">
                        <etools-datepicker
                                id="draftReportToIp"
                                modal="[[datepickerModal]]"
                                prefix
                                format="YYYY-MM-DD"
                                date="[[prepareDate(data.date_of_draft_report_to_ip)]]"
                                pretty-date="{{data.date_of_draft_report_to_ip}}"
                                max-date="{{maxDate}}"
                                no-init
                                show-clear-btn>
                        </etools-datepicker>
                    </paper-input>
                </div>

                <div class="input-container">
                    <!-- Comments Received by IP -->
                    <paper-input
                            id="commentsReceivedByIpInput"
                            class$="disabled-as-readonly [[_setRequired('date_of_comments_by_ip', basePermissionPath)]] validate-date"
                            value="[[prettyDate(data.date_of_comments_by_ip)]]"
                            label="[[getLabel('date_of_comments_by_ip', basePermissionPath)]]"
                            placeholder="&#8212;"
                            data-selector="commentsReceivedByIp"
                            required="[[_setRequired('date_of_comments_by_ip', basePermissionPath)]]"
                            disabled$="[[_isReadOnly('date_of_comments_by_ip', data.date_of_draft_report_to_ip, data.date_of_draft_report_to_unicef, basePermissionPath)]]"
                            invalid="{{_checkFieldInvalid(errors.date_of_comments_by_ip)}}"
                            error-message="{{errors.date_of_comments_by_ip}}"
                            validator="dateValidator"
                            on-focus="_resetFieldError"
                            on-tap="_resetFieldError"
                            on-down="openDatePicker">
                        <etools-datepicker
                                id="commentsReceivedByIp"
                                modal="[[datepickerModal]]"
                                prefix
                                format="YYYY-MM-DD"
                                date="[[prepareDate(data.date_of_comments_by_ip)]]"
                                pretty-date="{{data.date_of_comments_by_ip}}"
                                min-date="{{minDate(data.date_of_draft_report_to_ip)}}"
                                max-date="{{maxDate}}"
                                no-init
                                show-clear-btn>
                        </etools-datepicker>
                    </paper-input>
                </div>
            </div>

            <div class="row-h group">
                <div class="input-container">
                    <!-- Draft Report Issued to UNICEF -->
                    <paper-input
                            id="draftReportUnicefInput"
                            class$="disabled-as-readonly [[_setRequired('date_of_draft_report_to_unicef', basePermissionPath)]] validate-date"
                            value="[[prettyDate(data.date_of_draft_report_to_unicef)]]"
                            label="[[getLabel('date_of_draft_report_to_unicef', basePermissionPath)]]"
                            placeholder="&#8212;"
                            data-selector="draftReportUnicef"
                            required="[[_setRequired('date_of_draft_report_to_unicef', basePermissionPath)]]"
                            disabled$="[[_isReadOnly('date_of_draft_report_to_unicef', data.date_of_comments_by_ip, data.date_of_comments_by_unicef, basePermissionPath)]]"
                            invalid="{{_checkFieldInvalid(errors.date_of_draft_report_to_unicef)}}"
                            error-message="{{errors.date_of_draft_report_to_unicef}}"
                            validator="dateValidator"
                            on-focus="_resetFieldError"
                            on-tap="_resetFieldError"
                            on-down="openDatePicker">
                        <etools-datepicker
                                id="draftReportUnicef"
                                modal="[[datepickerModal]]"
                                prefix
                                format="YYYY-MM-DD"
                                date="[[prepareDate(data.date_of_draft_report_to_unicef)]]"
                                pretty-date="{{data.date_of_draft_report_to_unicef}}"
                                min-date="{{minDate(data.date_of_comments_by_ip)}}"
                                max-date="{{maxDate}}"
                                no-init
                                show-clear-btn>
                        </etools-datepicker>
                    </paper-input>
                </div>

                <div class="input-container">
                    <!-- Comments Received by UNICEF -->
                    <paper-input
                            id="commentsReceivedUnicefInput"
                            class$="disabled-as-readonly [[_setRequired('date_of_comments_by_unicef', basePermissionPath)]] validate-date"
                            value="[[prettyDate(data.date_of_comments_by_unicef)]]"
                            label="[[getLabel('date_of_comments_by_unicef', basePermissionPath)]]"
                            placeholder="&#8212;"
                            data-selector="commentsReceivedUnicef"
                            required="[[_setRequired('date_of_comments_by_unicef', basePermissionPath)]]"
                            disabled$="[[_isReadOnly('date_of_comments_by_unicef', data.date_of_draft_report_to_unicef, '', basePermissionPath)]]"
                            invalid="{{_checkFieldInvalid(errors.date_of_comments_by_unicef)}}"
                            error-message="{{errors.date_of_comments_by_unicef}}"
                            validator="dateValidator"
                            on-focus="_resetFieldError"
                            on-tap="_resetFieldError"
                            on-down="openDatePicker">
                        <etools-datepicker
                                id="commentsReceivedUnicef"
                                modal="[[datepickerModal]]"
                                prefix
                                format="YYYY-MM-DD"
                                date="[[prepareDate(data.date_of_comments_by_unicef)]]"
                                pretty-date="{{data.date_of_comments_by_unicef}}"
                                min-date="{{minDate(data.date_of_draft_report_to_unicef)}}"
                                max-date="{{maxDate}}"
                                no-init
                                show-clear-btn>
                        </etools-datepicker>
                    </paper-input>
                </div>

                <template is="dom-if" if="[[showExchange(basePermissionPath)]]">
                    <div class="input-container">
                        <!-- Exchange Rate -->
                        <etools-currency-amount-input
                                class$="validate-input disabled-as-readonly [[_setRequired('exchange_rate', basePermissionPath)]]"
                                value="{{data.exchange_rate}}"
                                currency="$"
                                label$="[[getLabel('exchange_rate', basePermissionPath)]]"
                                placeholder$="[[getPlaceholderText('exchange_rate', basePermissionPath)]]"
                                required$="[[_setRequired('exchange_rate', basePermissionPath)]]"
                                disabled$="[[isReadOnly('exchange_rate', basePermissionPath)]]"
                                readonly$="[[isReadOnly('exchange_rate', basePermissionPath)]]"
                                invalid="{{_checkInvalid(errors.exchange_rate)}}"
                                error-message="{{errors.exchange_rate}}"
                                on-focus="_resetFieldError"
                                on-tap="_resetFieldError">
                        </etools-currency-amount-input>
                    </div>
                </template>

            </div>
        </etools-content-panel>

        <custom-validator id="date-validator" validator-name="dateValidator"></custom-validator>
    </template>

    <!-- inject scripts './assign-engagement.js'-->
</dom-module>
