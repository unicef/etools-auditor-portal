<!--import [polymer, paper-icon-button, paper-input/paper-textarea, iron-icons, etools-content-panel, lodash, paper-tooltip]-->

<!--import [list-header, list-element, common-methods-behavior, tab-inputs-styles, module-styles, dialog-element,
            table-elements-behavior, permission-controller, textarea-max-rows-behavior]-->

<dom-module id="specific-procedure">
    <template>
        <style include="tab-inputs-styles tab-layout-styles module-styles"></style>
        <!-- inject styles './specific-procedure.scss'-->

        <etools-content-panel
                class="content-section clearfix"
                panel-title="[[getLabel('specific_procedures', basePermissionPath)]]">
            <div slot="panel-btns">
                <div hidden$="[[!canAddSP(basePermissionPath, readonlyTab, withoutFindingColumn)]]">
                    <paper-icon-button
                            class="panel-button"
                            on-tap="openAddDialog"
                            icon="add-box">
                    </paper-icon-button>
                    <paper-tooltip offset="0">Add</paper-tooltip>
                </div>
            </div>

            <list-header
                    id="list-header"
                    no-ordered
                    no-additional
                    data="[[columns]]"
                    base-permission-path="[[basePermissionPath]]">
            </list-header>

            <template is="dom-repeat" items="[[dataItems]]" filter="_showItems">
                <list-element
                        class="list-element"
                        data="[[item]]"
                        base-permission-path="[[basePermissionPath]]"
                        item-index="[[index]]"
                        headings="[[columns]]"
                        no-additional
                        multiline
                        no-animation>
                    <div slot="hover" class="edit-icon-slot" hidden$="[[!_canBeChanged(basePermissionPath)]]">
                        <paper-icon-button icon="icons:create" class="edit-icon" hidden$="[[_hideEditIcon(basePermissionPath, withoutFindingColumn, readonlyTab)]]"
                                           on-tap="openEditDialog"></paper-icon-button>
                        <paper-icon-button icon="icons:delete" class="edit-icon" on-tap="openDeleteDialog"
                                           hidden$="[[!canAddSP(basePermissionPath, readonlyTab, withoutFindingColumn)]]"></paper-icon-button>
                    </div>
                </list-element>
            </template>

            <template is="dom-if" if="[[!dataItems.length]]">
                <list-element
                        class="list-element"
                        data="[[emptyObj]]"
                        headings="[[columns]]"
                        no-additional
                        no-animation>
                </list-element>
            </template>
        </etools-content-panel>

        <dialog-element
                opened="{{dialogOpened}}"
                delete-dialog="[[deleteDialog]]"
                dialog-title="[[dialogTitle]]"
                confirm-btn-text="[[confirmBtnText]]"
                request-in-process="{{requestInProcess}}">
            <div class="row-h repeatable-item-container" without-line>
                <div class="repeatable-item-content">

                    <template is="dom-if" if="[[canAddSP(basePermissionPath, readonlyTab, withoutFindingColumn)]]" restamp>
                        <div class="row-h group">
                            <div class="input-container input-container-l">
                                <!-- Description -->
                                <paper-textarea
                                        class$="disabled-as-readonly fixed-width validate-input [[_setRequired('specific_procedures.description', basePermissionPath)]]"
                                        value="{{editedItem.description}}"
                                        allowed-pattern="[\d\s]"
                                        label="[[getLabel('specific_procedures.description', basePermissionPath)]]"
                                        placeholder="[[getPlaceholderText('specific_procedures.description', basePermissionPath)]]"
                                        required$="[[_setRequired('specific_procedures.description', basePermissionPath)]]"
                                        disabled$="[[requestInProcess]]"
                                        readonly$="[[requestInProcess]]"
                                        max-rows="4"
                                        invalid="[[_checkInvalid(errors.0.description)]]"
                                        error-message="[[errors.0.description]]"
                                        on-focus="_resetFieldError"
                                        on-tap="_resetFieldError">
                                </paper-textarea>
                            </div>
                        </div>
                    </template>

                    <template is="dom-if" if="[[!canAddSP(basePermissionPath, readonlyTab, withoutFindingColumn)]]" restamp>
                        <div class="row-h group">
                            <div class="input-container input-container-l">
                                <!-- Finding -->
                                <paper-textarea
                                        class$="disabled-as-readonly fixed-width validate-input [[_setRequired('specific_procedures.finding', basePermissionPath)]]"
                                        value="{{editedItem.finding}}"
                                        allowed-pattern="[\d\s]"
                                        label="[[getLabel('specific_procedures.finding', basePermissionPath)]]"
                                        placeholder="[[getPlaceholderText('specific_procedures.finding', basePermissionPath)]]"
                                        required$="[[_setRequired('specific_procedures.finding', basePermissionPath)]]"
                                        disabled$="[[requestInProcess]]"
                                        readonly$="[[requestInProcess]]"
                                        max-rows="4"
                                        invalid="[[_checkInvalid(errors.0.finding)]]"
                                        error-message="[[errors.0.finding]]"
                                        on-focus="_resetFieldError"
                                        on-tap="_resetFieldError">
                                </paper-textarea>
                            </div>
                        </div>
                    </template>


                </div>
            </div>
        </dialog-element>
    </template>

    <!-- inject scripts './specific-procedure.js'-->
</dom-module>